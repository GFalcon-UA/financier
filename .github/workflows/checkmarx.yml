name: scan with KICS and upload SARIF

on:
  push:
    branches: [ develop, master ]
  pull_request:
    # The branches below must be a subset of the branches above
    branches: [ develop, master ]

jobs:
  kics-job:
    runs-on: ubuntu-latest
    name: kics-action
    steps:
      - uses: actions/checkout@v2
      - name: run kics Scan
        uses: checkmarx/kics-action@v1.2
        with:
          path: 'backend,data,front,model,server,util'
          fail_on: high,medium,low
          output_path: 'results.json'
          verbose: true
      - name: display kics results
        run: |
          cat results.json
